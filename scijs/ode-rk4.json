{"readme":"<h1 class=\"title\"><a target=\"_blank\" href=\"https://github.com/scijs/ode-rk4\">ode-rk4   </a><div class=\"contrib\"></div></h1>\n<blockquote>\n<p>Integrate a system of ODEs using the Fourth Order Runge-Kutta (RK-4) method</p>\n</blockquote>\n<h2 id=\"introduction\">Introduction</h2>\n<p>This module integrates a system of ordinary differential equations of the form</p>\n<p align=\"center\"><img alt=\"\\begin{eqnarray*} y&apos;(t) &amp;=&amp; f(t, y(t)), \\\\ y(t_0) &amp;=&amp; y_0 \\end{eqnarray*}\" valign=\"middle\" src=\"https://raw.githubusercontent.com/scijs/ode-rk4/master/docs/images/begineqnarray-yt-ft-yt-yt_0-y_0-endeqnarray-0298eae3db.png\" width=\"187\" height=\"61\"></p>\n\n<p>where <img alt=\"y\" valign=\"middle\" src=\"https://raw.githubusercontent.com/scijs/ode-rk4/master/docs/images/y-720f311276.png\" width=\"14.5\" height=\"20\"> is a vector of length <img alt=\"n\" valign=\"middle\" src=\"https://raw.githubusercontent.com/scijs/ode-rk4/master/docs/images/n-9baedbc330.png\" width=\"16\" height=\"16\">. Given time step <img alt=\"\\Delta t\" valign=\"middle\" src=\"https://raw.githubusercontent.com/scijs/ode-rk4/master/docs/images/delta-t-a20a5fe4f2.png\" width=\"28\" height=\"16\">, the Runge-Kutta 4 method integrates the ODE with update</p>\n<p align=\"center\"><img alt=\"\\begin{eqnarray*} y_{n+1} &amp;=&amp; \\frac{\\Delta t}{6}\\left(k_1 + 2k_2 + 2k_3 + k_4\\right) \\\\ t_{n+1} &amp;=&amp; t_n + \\Delta t \\end{eqnarray*}\" valign=\"middle\" src=\"https://raw.githubusercontent.com/scijs/ode-rk4/master/docs/images/begineqnarray-y_n1-fracdelta-t6leftk_1-2k_2-2-41157480a7.png\" width=\"321.5\" height=\"71\"></p>\nwhere <img alt=\"k_n\" valign=\"middle\" src=\"https://raw.githubusercontent.com/scijs/ode-rk4/master/docs/images/k_n-d413726dee.png\" width=\"25.5\" height=\"19\"> are given by\n<p align=\"center\"><img alt=\"\\begin{eqnarray*} k_1 &amp;=&amp; f(t_n, y_n), \\\\ k_2 &amp;=&amp; f(t_n + \\frac{\\Delta t}{2}, y_n + \\frac{\\Delta t}{2} k_1), \\\\ k_3 &amp;=&amp; f(t_n + \\frac{\\Delta t}{2}, y_n + \\frac{\\Delta t}{2} k_2), \\\\ k_4 &amp;=&amp; f(t_n + \\Delta t, y_n + \\Delta tk_3).  \\end{eqnarray*}\" valign=\"middle\" src=\"https://raw.githubusercontent.com/scijs/ode-rk4/master/docs/images/begineqnarray-k_1-ft_n-y_n-k_2-ft_n-fracdelta-35d808c6ef.png\" width=\"288\" height=\"156.5\"></p>\n\n<p>For a similar adaptive method using the fifth order Cash-Karp Runge-Kutta method with fourth order embedded error estimator, see <a href=\"https://github.com/scijs/ode45-cash-karp\">ode45-cash-karp</a>.</p>\n<h2 id=\"install\">Install</h2>\n<pre><code class=\"lang-bash\"><div class=\"line\"><span class=\"source shell\"><span>$&#xA0;npm&#xA0;install&#xA0;ode-rk4</span></span></div>\n</code></pre>\n<h2 id=\"example\">Example</h2>\n<pre><code class=\"lang-javascript\"><div class=\"line\"><span class=\"source js\"><span class=\"storage type var js\"><span>var</span></span><span>&#xA0;rk4&#xA0;</span><span class=\"keyword operator assignment js\"><span>=</span></span><span>&#xA0;</span><span class=\"support function js\"><span>require</span></span><span class=\"meta brace round js\"><span>(</span></span><span class=\"string quoted single js\"><span class=\"punctuation definition string begin js\"><span>&apos;</span></span><span>ode-rk4</span><span class=\"punctuation definition string end js\"><span>&apos;</span></span></span><span class=\"meta brace round js\"><span>)</span></span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;</span></span></div><div class=\"line\"><span class=\"source js\"><span class=\"storage type var js\"><span>var</span></span><span>&#xA0;</span><span class=\"meta function js\"><span class=\"entity name function js\"><span>deriv</span></span><span>&#xA0;</span><span class=\"keyword operator assignment js\"><span>=</span></span><span>&#xA0;</span><span class=\"storage type function js\"><span>function</span></span><span class=\"punctuation definition parameters begin js\"><span>(</span></span><span class=\"variable parameter function js\"><span>dydt</span></span><span class=\"meta object delimiter js\"><span>,</span></span><span>&#xA0;</span><span class=\"variable parameter function js\"><span>y</span></span><span class=\"meta object delimiter js\"><span>,</span></span><span>&#xA0;</span><span class=\"variable parameter function js\"><span>t</span></span><span class=\"punctuation definition parameters end js\"><span>)</span></span></span><span>&#xA0;</span><span class=\"meta brace curly js\"><span>{</span></span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;dydt</span><span class=\"meta brace square js\"><span>[</span></span><span class=\"constant numeric js\"><span>0</span></span><span class=\"meta brace square js\"><span>]</span></span><span>&#xA0;</span><span class=\"keyword operator assignment js\"><span>=</span></span><span>&#xA0;</span><span class=\"keyword operator js\"><span>-</span></span><span>y</span><span class=\"meta brace square js\"><span>[</span></span><span class=\"constant numeric js\"><span>1</span></span><span class=\"meta brace square js\"><span>]</span></span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;dydt</span><span class=\"meta brace square js\"><span>[</span></span><span class=\"constant numeric js\"><span>1</span></span><span class=\"meta brace square js\"><span>]</span></span><span>&#xA0;</span><span class=\"keyword operator assignment js\"><span>=</span></span><span>&#xA0;&#xA0;y</span><span class=\"meta brace square js\"><span>[</span></span><span class=\"constant numeric js\"><span>0</span></span><span class=\"meta brace square js\"><span>]</span></span></span></div><div class=\"line\"><span class=\"source js\"><span class=\"meta brace curly js\"><span>}</span></span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;</span></span></div><div class=\"line\"><span class=\"source js\"><span class=\"storage type var js\"><span>var</span></span><span>&#xA0;y0&#xA0;</span><span class=\"keyword operator assignment js\"><span>=</span></span><span>&#xA0;</span><span class=\"meta brace square js\"><span>[</span></span><span class=\"constant numeric js\"><span>1</span></span><span class=\"meta delimiter object comma js\"><span>,</span></span><span class=\"constant numeric js\"><span>0</span></span><span class=\"meta brace square js\"><span>]</span></span></span></div><div class=\"line\"><span class=\"source js\"><span class=\"storage type var js\"><span>var</span></span><span>&#xA0;n&#xA0;</span><span class=\"keyword operator assignment js\"><span>=</span></span><span>&#xA0;</span><span class=\"constant numeric js\"><span>1000</span></span></span></div><div class=\"line\"><span class=\"source js\"><span class=\"storage type var js\"><span>var</span></span><span>&#xA0;t0&#xA0;</span><span class=\"keyword operator assignment js\"><span>=</span></span><span>&#xA0;</span><span class=\"constant numeric js\"><span>0</span></span></span></div><div class=\"line\"><span class=\"source js\"><span class=\"storage type var js\"><span>var</span></span><span>&#xA0;dt&#xA0;</span><span class=\"keyword operator assignment js\"><span>=</span></span><span>&#xA0;</span><span class=\"constant numeric js\"><span>2.0</span></span><span>&#xA0;</span><span class=\"keyword operator js\"><span>*</span></span><span>&#xA0;</span><span class=\"variable other object js\"><span>Math</span></span><span class=\"meta delimiter property period js\"><span>.</span></span><span class=\"support constant js\"><span>PI</span></span><span>&#xA0;</span><span class=\"keyword operator js\"><span>/</span></span><span>&#xA0;n</span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;</span></span></div><div class=\"line\"><span class=\"source js\"><span class=\"storage type var js\"><span>var</span></span><span>&#xA0;integrator&#xA0;</span><span class=\"keyword operator assignment js\"><span>=</span></span><span>&#xA0;</span><span class=\"meta function-call js\"><span class=\"entity name function js\"><span>rk4</span></span><span class=\"punctuation definition arguments begin js\"><span>(</span></span><span>&#xA0;y0</span><span class=\"meta delimiter object comma js\"><span>,</span></span><span>&#xA0;deriv</span><span class=\"meta delimiter object comma js\"><span>,</span></span><span>&#xA0;t0</span><span class=\"meta delimiter object comma js\"><span>,</span></span><span>&#xA0;dt&#xA0;</span><span class=\"punctuation definition arguments end js\"><span>)</span></span></span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;</span></span></div><div class=\"line\"><span class=\"source js\"><span class=\"comment line double-slash js\"><span class=\"punctuation definition comment js\"><span>//</span></span><span>&#xA0;Integrate&#xA0;1000&#xA0;steps:</span><span>&#xA0;</span></span></span></div><div class=\"line\"><span class=\"source js\"><span class=\"variable other object js\"><span>integrator</span></span><span class=\"meta method-call js\"><span class=\"meta delimiter method period js\"><span>.</span></span><span class=\"entity name function js\"><span>steps</span></span><span class=\"punctuation definition arguments begin js\"><span>(</span></span><span>n</span><span class=\"punctuation definition arguments end js\"><span>)</span></span></span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;</span></span></div><div class=\"line\"><span class=\"source js\"><span class=\"comment line double-slash js\"><span class=\"punctuation definition comment js\"><span>//</span></span><span>&#xA0;Integrate&#xA0;all&#xA0;the&#xA0;way&#xA0;around&#xA0;a&#xA0;circle:</span><span>&#xA0;</span></span></span></div><div class=\"line\"><span class=\"source js\"><span class=\"comment line double-slash js\"><span class=\"punctuation definition comment js\"><span>//</span></span><span>&#xA0;=&gt;&#xA0;integrator.y&#xA0;=&#xA0;[&#xA0;0.9999999999995743,&#xA0;-8.160481752145232e-11&#xA0;]</span><span>&#xA0;</span></span></span></div>\n</code></pre>\n<h2 id=\"api\">API</h2>\n<h3 id=\"-require-ode-rk4-y0-deriv-t0-dt-\"><code>require(&apos;ode-rk4&apos;)( y0, deriv, t0, dt )</code></h3>\n<p><strong>Arguments:</strong></p>\n<ul>\n<li><code>y0</code>: an array or typed array containing initial conditions. This vector is updated in-place with each integrator step.</li>\n<li><code>deriv</code>: a function that calculates the derivative. Format is <code>function( dydt, y, t )</code>. Inputs are current state <code>y</code> and current time <code>t</code>, output is the calculated derivative <code>dydt</code>.</li>\n<li><code>t0</code>: initial time <img alt=\"t\" valign=\"middle\" src=\"https://raw.githubusercontent.com/scijs/ode-rk4/master/docs/images/t-fc93da6f4d.png\" width=\"11.5\" height=\"16\">.</li>\n<li><code>dt</code>: time step <img alt=\"\\Delta t\" valign=\"middle\" src=\"https://raw.githubusercontent.com/scijs/ode-rk4/master/docs/images/delta-t-a20a5fe4f2.png\" width=\"28\" height=\"16\">.</li>\n</ul>\n<p><strong>Returns</strong>:\nInitialized integrator object.</p>\n<p><strong>Properties:</strong></p>\n<ul>\n<li><code>n</code>: dimension of <code>y0</code>.</li>\n<li><code>y</code>: current state. Initialized as a shallow copy of input <code>y0</code>.</li>\n<li><code>deriv</code>: function that calculates the derivative. Initialized from input. May be changed.</li>\n<li><code>t</code>: current time, incremented by <code>dt</code> with each time step.</li>\n<li><code>dt</code>: time step <img alt=\"\\Delta t\" valign=\"middle\" src=\"https://raw.githubusercontent.com/scijs/ode-rk4/master/docs/images/delta-t-a20a5fe4f2.png\" width=\"28\" height=\"16\">. Initialized from input <code>dt</code>. May be changed.</li>\n</ul>\n<p><strong>Methods:</strong></p>\n<ul>\n<li><code>.step()</code>: takes a single step of the RK-4 integrator and stores the result in-place in the <code>y</code> property.</li>\n<li><code>.steps( n )</code>: takes <code>n</code> steps of the RK-4 integrator, storing the result in-place in the <code>y</code> property.</li>\n</ul>\n<h2 id=\"credits\">Credits</h2>\n<p>(c) 2015 Ricky Reusser. MIT License</p>\n"}