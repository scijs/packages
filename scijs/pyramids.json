{"readme":"<h1 class=\"title\"><a target=\"_blank\" href=\"https://github.com/scijs/pyramids\">Pyramids</a><div class=\"contrib\"></div></h1>\n<p>Image pyramids give a (slightly) overcomplete multiscale representation of an image, based on a reduce operator that reduces the size of an image by a factor of two (note though that conventionally, level 0 is the original scale, and higher levels correspond to smaller sizes). Example usage:</p>\n<pre><code class=\"lang-javascript\"><div class=\"line\"><span class=\"source js\"><span class=\"storage type var js\"><span>var</span></span><span>&#xA0;pyramid&#xA0;</span><span class=\"keyword operator assignment js\"><span>=</span></span><span>&#xA0;</span><span class=\"support function js\"><span>require</span></span><span class=\"meta brace round js\"><span>(</span></span><span class=\"string quoted double js\"><span class=\"punctuation definition string begin js\"><span>&quot;</span></span><span>pyramids</span><span class=\"punctuation definition string end js\"><span>&quot;</span></span></span><span class=\"meta brace round js\"><span>)</span></span></span></div><div class=\"line\"><span class=\"source js\"><span class=\"storage type var js\"><span>var</span></span><span>&#xA0;ndarray&#xA0;</span><span class=\"keyword operator assignment js\"><span>=</span></span><span>&#xA0;</span><span class=\"support function js\"><span>require</span></span><span class=\"meta brace round js\"><span>(</span></span><span class=\"string quoted double js\"><span class=\"punctuation definition string begin js\"><span>&quot;</span></span><span>ndarray</span><span class=\"punctuation definition string end js\"><span>&quot;</span></span></span><span class=\"meta brace round js\"><span>)</span></span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;</span></span></div><div class=\"line\"><span class=\"source js\"><span class=\"storage type var js\"><span>var</span></span><span>&#xA0;p&#xA0;</span><span class=\"keyword operator assignment js\"><span>=</span></span><span>&#xA0;</span><span class=\"meta function-call js\"><span class=\"entity name function js\"><span>pyramid</span></span><span class=\"punctuation definition arguments begin js\"><span>(</span></span><span class=\"meta function-call js\"><span class=\"entity name function js\"><span>ndarray</span></span><span class=\"punctuation definition arguments begin js\"><span>(</span></span><span class=\"meta class instance constructor\"><span class=\"keyword operator new js\"><span>new</span></span><span>&#xA0;</span><span class=\"entity name type instance js\"><span>Int32Array</span></span></span><span class=\"meta brace round js\"><span>(</span></span><span class=\"meta brace square js\"><span>[</span></span><span class=\"constant numeric js\"><span>11</span></span><span class=\"meta delimiter object comma js\"><span>,</span></span><span class=\"constant numeric js\"><span>10</span></span><span class=\"meta delimiter object comma js\"><span>,</span></span><span class=\"constant numeric js\"><span>6</span></span><span class=\"meta delimiter object comma js\"><span>,</span></span><span class=\"constant numeric js\"><span>12</span></span><span class=\"meta delimiter object comma js\"><span>,</span></span><span class=\"constant numeric js\"><span>3</span></span><span class=\"meta delimiter object comma js\"><span>,</span></span><span class=\"constant numeric js\"><span>2</span></span><span class=\"meta delimiter object comma js\"><span>,</span></span><span class=\"constant numeric js\"><span>15</span></span><span class=\"meta delimiter object comma js\"><span>,</span></span><span class=\"constant numeric js\"><span>9</span></span><span class=\"meta delimiter object comma js\"><span>,</span></span><span class=\"constant numeric js\"><span>4</span></span><span class=\"meta delimiter object comma js\"><span>,</span></span><span class=\"constant numeric js\"><span>5</span></span><span class=\"meta delimiter object comma js\"><span>,</span></span><span class=\"constant numeric js\"><span>14</span></span><span class=\"meta delimiter object comma js\"><span>,</span></span><span class=\"constant numeric js\"><span>7</span></span><span class=\"meta delimiter object comma js\"><span>,</span></span><span class=\"constant numeric js\"><span>13</span></span><span class=\"meta delimiter object comma js\"><span>,</span></span><span class=\"constant numeric js\"><span>8</span></span><span class=\"meta delimiter object comma js\"><span>,</span></span><span class=\"constant numeric js\"><span>1</span></span><span class=\"meta brace square js\"><span>]</span></span><span class=\"punctuation definition arguments end js\"><span>)</span></span></span><span class=\"meta delimiter object comma js\"><span>,</span></span><span>&#xA0;</span><span class=\"meta brace square js\"><span>[</span></span><span class=\"constant numeric js\"><span>3</span></span><span class=\"meta delimiter object comma js\"><span>,</span></span><span class=\"constant numeric js\"><span>5</span></span><span class=\"meta brace square js\"><span>]</span></span><span class=\"punctuation definition arguments end js\"><span>)</span></span></span><span class=\"meta delimiter object comma js\"><span>,</span></span><span>&#xA0;</span><span class=\"variable other object js\"><span>pyramid</span></span><span class=\"meta delimiter property period js\"><span>.</span></span><span class=\"variable other property js\"><span>adjunction</span></span><span class=\"meta brace round js\"><span>)</span></span></span></div>\n</code></pre>\n<p>The above computes a pyramid using erosion (local minima, in this case within each 2-by-2 block), of the following &quot;image&quot; (array):</p>\n<table>\n<tr><td align=\"right\">11</td><td align=\"right\">10</td><td align=\"right\">6</td><td align=\"right\">12</td><td align=\"right\">3</td></tr>\n<tr><td align=\"right\">2</td><td align=\"right\">15</td><td align=\"right\">9</td><td align=\"right\">4</td><td align=\"right\">5</td></tr>\n<tr><td align=\"right\">14</td><td align=\"right\">7</td><td align=\"right\">13</td><td align=\"right\">8</td><td align=\"right\">1</td></tr>\n</table>\n\n<p>The result is a list of ndarrays, with the first array (corresponding to level 0) being the original ndarray object. The array at level 1 is given by:</p>\n<table>\n<tr><td align=\"right\">2</td><td align=\"right\">4</td><td align=\"right\">3</td></tr>\n<tr><td align=\"right\">7</td><td align=\"right\">8</td><td align=\"right\">1</td></tr>\n</table>\n\n<h3 id=\"-require-pyramids-array-scheme-maxlevel-\"><code>require(&quot;pyramids&quot;)(array, scheme[, maxlevel])</code></h3>\n<p>Returns a list containing <code>array</code>, followed by <code>maxlevel</code> (higher) levels of a pyramid based on the reduce operator of <code>scheme</code> (each an ndarray with the same type of data storage as <code>array</code>). If <code>maxlevel</code> is unspecified, it returns as many levels are necessary to end up with an array containing just one element. Note that the first level is simply the argument given to the function.</p>\n<p>There is no restriction on the dimensionality of <code>array</code>, but a typed array must be used for storing the data in <code>array</code> (otherwise the pool allocator used internally will fail).</p>\n<h3 id=\"-require-pyramids-detail-array-scheme-maxlevel-\"><code>require(&quot;pyramids&quot;).detail(array, scheme[, maxlevel])</code></h3>\n<p>Same as <code>require(&quot;pyramids&quot;)</code>, but generates a detail pyramid. That is, all but the last level have been generated by expanding the next level and subtracting it from the current level.</p>\n<h3 id=\"-require-pyramids-reconstruct-detailpyramid-scheme-\"><code>require(&quot;pyramids&quot;).reconstruct(detailPyramid, scheme)</code></h3>\n<p>Reconstructs an image from a given detail pyramid (as output by the <code>detail</code> function). The reconstruction is done in-place. For example:</p>\n<pre><code class=\"lang-javascript\"><div class=\"line\"><span class=\"source js\"><span class=\"storage type var js\"><span>var</span></span><span>&#xA0;pyramid&#xA0;</span><span class=\"keyword operator assignment js\"><span>=</span></span><span>&#xA0;</span><span class=\"support function js\"><span>require</span></span><span class=\"meta brace round js\"><span>(</span></span><span class=\"string quoted double js\"><span class=\"punctuation definition string begin js\"><span>&quot;</span></span><span>pyramids</span><span class=\"punctuation definition string end js\"><span>&quot;</span></span></span><span class=\"meta brace round js\"><span>)</span></span></span></div><div class=\"line\"><span class=\"source js\"><span class=\"storage type var js\"><span>var</span></span><span>&#xA0;p&#xA0;</span><span class=\"keyword operator assignment js\"><span>=</span></span><span>&#xA0;</span><span class=\"variable other object js\"><span>pyramid</span></span><span class=\"meta method-call js\"><span class=\"meta delimiter method period js\"><span>.</span></span><span class=\"entity name function js\"><span>detail</span></span><span class=\"punctuation definition arguments begin js\"><span>(</span></span><span class=\"meta function-call js\"><span class=\"entity name function js\"><span>ndarray</span></span><span class=\"punctuation definition arguments begin js\"><span>(</span></span><span class=\"meta class instance constructor\"><span class=\"keyword operator new js\"><span>new</span></span><span>&#xA0;</span><span class=\"entity name type instance js\"><span>Int32Array</span></span></span><span class=\"meta brace round js\"><span>(</span></span><span class=\"meta brace square js\"><span>[</span></span><span class=\"constant numeric js\"><span>11</span></span><span class=\"meta delimiter object comma js\"><span>,</span></span><span class=\"constant numeric js\"><span>10</span></span><span class=\"meta delimiter object comma js\"><span>,</span></span><span class=\"constant numeric js\"><span>6</span></span><span class=\"meta delimiter object comma js\"><span>,</span></span><span class=\"constant numeric js\"><span>12</span></span><span class=\"meta delimiter object comma js\"><span>,</span></span><span class=\"constant numeric js\"><span>3</span></span><span class=\"meta delimiter object comma js\"><span>,</span></span><span class=\"constant numeric js\"><span>2</span></span><span class=\"meta delimiter object comma js\"><span>,</span></span><span class=\"constant numeric js\"><span>15</span></span><span class=\"meta delimiter object comma js\"><span>,</span></span><span class=\"constant numeric js\"><span>9</span></span><span class=\"meta delimiter object comma js\"><span>,</span></span><span class=\"constant numeric js\"><span>4</span></span><span class=\"meta delimiter object comma js\"><span>,</span></span><span class=\"constant numeric js\"><span>5</span></span><span class=\"meta delimiter object comma js\"><span>,</span></span><span class=\"constant numeric js\"><span>14</span></span><span class=\"meta delimiter object comma js\"><span>,</span></span><span class=\"constant numeric js\"><span>7</span></span><span class=\"meta delimiter object comma js\"><span>,</span></span><span class=\"constant numeric js\"><span>13</span></span><span class=\"meta delimiter object comma js\"><span>,</span></span><span class=\"constant numeric js\"><span>8</span></span><span class=\"meta delimiter object comma js\"><span>,</span></span><span class=\"constant numeric js\"><span>1</span></span><span class=\"meta brace square js\"><span>]</span></span><span class=\"punctuation definition arguments end js\"><span>)</span></span></span><span class=\"meta delimiter object comma js\"><span>,</span></span><span>&#xA0;</span><span class=\"meta brace square js\"><span>[</span></span><span class=\"constant numeric js\"><span>3</span></span><span class=\"meta delimiter object comma js\"><span>,</span></span><span class=\"constant numeric js\"><span>5</span></span><span class=\"meta brace square js\"><span>]</span></span><span class=\"punctuation definition arguments end js\"><span>)</span></span></span><span class=\"meta delimiter object comma js\"><span>,</span></span><span>&#xA0;</span><span class=\"variable other object js\"><span>pyramid</span></span><span class=\"meta delimiter property period js\"><span>.</span></span><span class=\"variable other property js\"><span>adjunction</span></span><span class=\"meta brace round js\"><span>)</span></span></span></div><div class=\"line\"><span class=\"source js\"><span class=\"comment line double-slash js\"><span class=\"punctuation definition comment js\"><span>//</span></span><span>&#xA0;do&#xA0;something&#xA0;with&#xA0;the&#xA0;detail&#xA0;pyramid</span><span>&#xA0;</span></span></span></div><div class=\"line\"><span class=\"source js\"><span class=\"variable other object js\"><span>pyramid</span></span><span class=\"meta method-call js\"><span class=\"meta delimiter method period js\"><span>.</span></span><span class=\"entity name function js\"><span>reconstruct</span></span><span class=\"punctuation definition arguments begin js\"><span>(</span></span><span>p</span><span class=\"meta delimiter object comma js\"><span>,</span></span><span>&#xA0;</span><span class=\"variable other object js\"><span>pyramid</span></span><span class=\"meta delimiter property period js\"><span>.</span></span><span class=\"variable other property js\"><span>adjunction</span></span><span class=\"punctuation definition arguments end js\"><span>)</span></span></span></span></div><div class=\"line\"><span class=\"source js\"><span class=\"comment line double-slash js\"><span class=\"punctuation definition comment js\"><span>//</span></span><span>&#xA0;p&#xA0;now&#xA0;contains&#xA0;a&#xA0;normal&#xA0;pyramid&#xA0;(with&#xA0;the&#xA0;first&#xA0;level&#xA0;corresponding&#xA0;to&#xA0;the&#xA0;full&#xA0;resolution&#xA0;reconstructed&#xA0;image)</span><span>&#xA0;</span></span></span></div>\n</code></pre>\n<h2 id=\"morphological-pyramids\">Morphological pyramids</h2>\n<p>Non-linear pyramids based on reduce and expand operators that satisfy the so-called pyramid condition: first expanding an image and then reducing it recovers the original image.</p>\n<h3 id=\"-require-pyramids-adjunction-\"><code>require(&quot;pyramids&quot;).adjunction</code></h3>\n<p>The adjunction pyramid has a reduce operator based on erosion, as described in</p>\n<blockquote>\n<p>Nonlinear multiresolution signal decomposition schemes &#x2014; Part I: Morphological pyramids &apos;&apos;IEEE Transactions on Image Processing&apos;&apos;, Vol. 9, No. 11. (November 2000), pp. 1862-1876, doi:<a href=\"http://dx.doi.org/10.1109/83.877209\">10.1109/83.877209</a> by John Goutsias, Henk J. A. M. Heijmans.</p>\n</blockquote>\n<p>The structuring element used here is a (flat) 2-by-2 square in 2D, and in general a hypercube with sides of length 2. The expand operator uses the dilation that forms an adjunction with the erosion.</p>\n<h3 id=\"-require-pyramids-sunmaragos-\"><code>require(&quot;pyramids&quot;).SunMaragos</code></h3>\n<p>The SunMaragos pyramid has an opening (rather than an erosion) as reduce operator. The same structuring element is used as in the adjunction pyramid, based on the results in</p>\n<blockquote>\n<p>A New Class of Morphological Pyramids for Multiresolution Image Analysis In Geometry, Morphology, and Computational Imaging, Vol. 2616 (2003), pp. 165-175, doi:<a href=\"http://dx.doi.org/10.1007/3-540-36586-9_11\">10.1007/3-540-36586-9_11</a> by Jos B. T. M. Roerdink edited by Tetsuo Asano, Reinhard Klette, Christian Ronse.</p>\n</blockquote>\n<p>This pyramid tends to preserve more of the image than the adjunction pyramid. However, the same expand operator is used as for the adjunction pyramid. Note that (according to Goutsias and Heijmans, 2000) Sun and Maragos originally used a different structuring element (of length 3).</p>\n<h2 id=\"linear-pyramids\">Linear pyramids</h2>\n<p>Non-linear pyramids based on reduce and expand operators that satisfy the so-called pyramid condition: first expanding an image and then reducing it recovers the original image.</p>\n<h3 id=\"-require-pyramids-binomial-\"><code>require(&quot;pyramids&quot;).binomial</code></h3>\n<p>This is a very basic pyramid that is not ideal for all purposes. However, it is essentially equivalent to the traditional Gaussian pyramid, and the Laplacian pyramid if a detail pyramid is computed. It uses a binomial filter (<code>[1,4,6,4,1]/16</code>) with the reduce and expand operators defined here:</p>\n<blockquote>\n<p>The Laplacian Pyramid as a Compact Image Code &apos;&apos;IEEE Transactions on Communications&apos;&apos;, Vol. 31, No. 4. (April 1983), pp. 532-540, doi:<a href=\"http://dx.doi.org/10.1109/tcom.1983.1095851\">10.1109/tcom.1983.1095851</a> by Peter J. Burt, Edward H. Adelson</p>\n</blockquote>\n"}